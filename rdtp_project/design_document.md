# Документ по проектированию: Протокол RDTP на базе Go-Back-N

## 1. Описание выбранного алгоритма

Для реализации протокола надежной передачи данных (RDTP) был выбран алгоритм **Go-Back-N (GBN)**. Этот алгоритм использует технологию скользящего окна для управления потоком данных и обеспечения надежности поверх ненадежного UDP-канала.

### Ключевые принципы GBN:

*   **Отправитель (Sender):** Может отправлять до `N` пакетов (размер окна), не ожидая подтверждения на каждый из них. Ведется учет "базы" (`base` — старейший не подтвержденный пакет) и следующего порядкового номера (`next_seq_num`).
*   **Получатель (Receiver):** Принимает пакеты строго по порядку. Если приходит пакет с ожидаемым порядковым номером (`expected_seq_num`), он принимается, и получатель отправляет **кумулятивное подтверждение (ACK)**. Если пакет приходит не по порядку, он отбрасывается, а получатель повторно отправляет ACK на последний успешно принятый пакет.
*   **Таймауты и повторные передачи:** Отправитель использует один таймер для старейшего не подтвержденного пакета (`base`). Если таймер истекает, отправитель предполагает, что этот пакет (и, возможно, все последующие в окне) был потерян. Он **повторно отправляет все пакеты** в текущем окне, начиная с `base`.

Этот подход относительно прост в реализации, так как получателю не нужно буферизовать пакеты, пришедшие не по порядку.

## 2. Формат пакета

Для протокола RDTP определена единая структура пакета, используемая как для данных, так и для подтверждений.

```c++
#pragma pack(push, 1)
struct RdtpPacket {
    uint32_t seq_num;    // Порядковый номер пакета
    uint32_t ack_num;    // Номер подтверждаемого пакета
    uint16_t checksum;   // Контрольная сумма для проверки целостности
    uint16_t flags;      // Флаги (DATA, ACK, FIN)
    char data;     // Полезные данные
};
#pragma pack(pop)